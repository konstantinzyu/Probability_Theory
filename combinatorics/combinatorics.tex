\section{Элементарная комбинаторика}

\subsection{Элементарные факты для подсчёта числа комбинаций}

Центральной задачей комбинаторной математики можно считать задачу расположения объектов в соответствии со специальными правилами и нахождения числа способов, которыми это может быть сделано.
Для нахождения числа способов полезны следующие результаты.

\begin{lemma}%[о правиле суммы]
	Мощность объединения двух конечных множеств $A$ и $B$ равна
	$$|A\cup B| = |A| + |B| - |A\cap B|.$$
\end{lemma}
\textbf{Доказательство} проводится изображением диаграммы Элера-Венна и подсчётом элементов в её частях. $\Box$


\begin{lemma}[формула включений--исключений]
	$$\left|\bigcup_{i=1}^{n}A_i \right| = \sum_{i} | A_i | - \sum_{i<j} | A_i \cap A_j | + \sum_{i<j<k} | A_i \cap A_j \cap A_k | - \ldots$$
	$$\ldots + (-1)^{n-1} | A_1 \cap A_2 \cap \ldots \cap A_n |.$$
\end{lemma}
\noindent\textbf{Доказательство} проводится по индукции с помощью предыдущей леммы, которая используется как база и шаг индукции одновременно. $\Box$

\begin{lemma}%[о правиле произведения]
	Число пар, которые можно составить, когда первый элемент выбирается из множества $A$, а второй независимо от первого берется из множества $B$ равно $|A|\cdot|B|$.
\end{lemma}
\noindent\textbf{Доказательство.} Следует из формулы $|A\times B| = |A|\cdot|B|$. $\Box$


\begin{lemma}%[о числе кортежей]
	Число кортежей $(a_1, \ldots, a_n)$ в которых независимо выбираются первый элемент $a_1$ из множества $A_1$, второй $a_2$ --- из множества $A_2$, \ldots, $a_n$ --- из множества, равно  $|A_1|\cdot|A_2|\cdot\ldots\cdot|A_n|$.
\end{lemma}
\noindent\textbf{Доказательство.} По индукции из предыдущей леммы. $\Box$

\subsection{Классические комбинаторные величины}

\defin{Перестановка}{permutation} --- это расположение $n$ различных объектов по различным местам.
Число перестановок множества в $n$ элементов обозначаем $P_n$. Например, число способов разложить девять подписанных писем в девять подписанных конвертов --- это число перестановок $P_9$.


\defin{Перестановка с повторениями}{permutation_repetitions} --- это расположение $n$ объектов, некоторые из которых могут быть тождественны друг другу, по различным местам.
Число перестановок множества в $n$ элементов, где $n_1$ элементов 1-го типа, \ldots, $n_k$ элементов $k$-того типа (причём $n_1+\ldots+n_k=n$) обозначаем $P(n_1, \ldots, n_k)$. Например, число способов составить из букв слова <<математика>> всевозможные (абстрактные) слова --- это число перестановок с повторениями $P(2,3,2,1,1,1)$.

Упорядоченная выборка (кортеж) в $m$ элементов из множества в $n$ элементов называется \defin{размещением}{partial_permutation}, неупорядоченная выборка (подмножество) из $n$ элементов по $m$ называется \defin{сочетанием}{combination}.
Выборка может быть \underline{без повторений}, если элементы повторяться не могут, и может быть \underline{с повторениями}, если элементы в выборке повторяются. 
Число размещений без повторений обозначается $A_n^m$, с повторениями --- $\widetilde{A}_n^m$.
Число сочетаний без повторений обозначается $C_n^m$ или $\binom{n}{k}$, с повторениями --- $\widetilde{C}_n^m$ или $\left(\binom{n}{k}\right)$.

Примеры:
\begin{enumerate}
	\item Число способов расставить шесть книг из имеющихся восьми на книжкой полке --- это число размещений без повторения $A_{8}^{6}$.
	\item Число способов выбрать команду в пять человек из девяти данных игроков --- это число сочетаний без повторения $C_9^5$.
	\item Число способов купить семь ручек из продающихся ручек пяти фирм --- это число сочетаний с повторениями $\widetilde{C}_5^7$.
\end{enumerate}


\begin{theorem}[о комбинаторных числах]
	Числа перестановок, размещений и сочетаний находятся для неотрицательных целых\ $n, n_i, m$\ по следующим формулам (для комбинаций без повторений дополнительно требуется $m\leqslant n$):
	%\vspace{2mm}
	\begin{tabular}[c]{|p{8em}|p{12em}|p{12em}|}
		\hline
		Комбинация & без повторений & с повторениями  \\ \hline
		перестановка    & $P_n=n!$ & $P(n_1, \ldots, n_k)=\frac{\left(n_1+\ldots+n_k\right)!}{n_1!\cdot\ldots\cdot n_k!}$ \\ \hline
		размещение    & $A_n^m=n^{[m]}={\frac{n!}{(n-m)!}}^{\phantom{M}}$ & $\widetilde{A}_n^m=n^m$ \\ \hline
		сочетание  & $C_n^m=\frac{n!}{m!(n-m)!}$      & $\widetilde{C}_n^m=C_{n+m-1}^m={\frac{(n+m-1)!}{m!(n-1)!}}^{\phantom{M}}$ \\ \hline
	\end{tabular}
\end{theorem}
\noindent\textbf{Доказательство.}

Для $A_n^k$ применяем принцип умножения: $n\times(n-1)\times\cdots\times(n-k+1)=\frac{n!}{(n-k)!}.$ 

Для $C_n^k$ замечаем, что выбрать $k$ и упорядочить их можно $A_n^k$ способами, причём каждый набор упорядочен $k!$ раз, поэтому
$C_n^k=\frac{A_n^k}{k!}=\frac{n!}{k!\,(n-k)!}.$

Для $\widetilde{C}_n^m$ рассуждаем следующие образом.
Необходимо выбрать из набора из $n$ различных типов предметов ровно $m$ предметов, причём каждый тип можно выбрать несколько раз (т.е. с повторениями), и порядок выбора не важен.
Представим каждую из выбранных $m$ «штук» как звёздочку ($\ast$), а разделители между типами — как палочки ($|$).
Всего типов $n$, значит между этими типами нужно разместить $n-1$ разделитель.
Расположение звёзд и палочек вдоль одной оси однозначно кодирует, сколько звёзд (предметов) взято каждого типа.
Всего символов («звёзд» и «палочек») $= m + (n-1)$. Из них нужно выбрать $m$ позиций для звёзд (или, эквивалентно, $n-1$ позиций для палочек). Таким образом число всех конфигураций равно числу способов выбрать $m$ позиций из $(m + n - 1)$, т.е.
$\widetilde{C}_n^m =  C_{\,n + m - 1}^{\,m}. \Box$

\subsection{Свойства комбинаторных величин}


\begin{theorem}[о свойствах числа сочетаний]
	$$C_n^m=P(m,n-m) \quad (m\leqslant n);$$
	$$C_n^m=C_n^{n-m} \quad (m\leqslant n);$$
	$$C_n^m=\tfrac{n}{m}\cdot C_{n-1}^{m-1} \quad (m\leqslant n);$$
	$$C_n^m+C_n^{m+1}=C_{n+1}^{m+1} \quad (m<n).$$
\end{theorem}


\begin{theorem}[о биноме Ньютона]
	$$(x+y)^n = \sum_{k=0}^n C_{n}^{k} x^{n - k} y^k =$$
	$$={C_n^0}x^n + {C_n^1}x^{n - 1}y + \ldots + {C_n^k}x^{n - k}y^k + \ldots + {C_n^n}y^n;$$
\end{theorem}

В связи с этой теоремой числа сочетаний $C_n^m=\binom{n}{m}$ называют биномиальными коэффициентами.

Бином Ньютона может быть обобщён до полинома Ньютона --- возведения в степень суммы произвольного числа слагаемых:
\begin{theorem}[о мультиноме Ньютона]
	$$(x_1 + x_2 + \cdots + x_k)^n =\sum\limits_{n_j \geqslant 0 \atop n_1 + n_2 + \cdots + n_k = n} P(n_1, \cdots, n_k) x_1^{n_1} \ldots x_k^{n_k}.$$
\end{theorem}

В связи с формулой из теоремы число $P(n_1,  \cdots, n_k)$ также называется мультиномиальным коэффициентом и обозначается  $\binom{n}{n_1, n_2, \ldots, n_k}$.
\medskip

При $k=2$ мультиномиальный коэффциент совпадает с биномиальным $\binom{n_1+n_2}{n_1, n_2}=\binom{n_1+n_2}{n_1}=\binom{n_1+n_2}{n_2}$.
\bigskip

\textbf{Урновая схема.}
Пусть имеется $n$ урн, пронумерованных от $1$ до $n$. 
Разместим в урны произвольным образом $m$ шаров, где $m\leqslant n$.
Число способов разместить шары зависит от двух условий: (1) различимы ли шары или нет; (2) имеет ли место принцип исключения, который не позволяет положить второй шар в урну, уже содержащую один шар. 
Это число способов в зависимости от комбинации условий находится как одно из известных комбинаторных чисел:
\bigskip

\begin{tabular}[c]{|p{5em}|p{10em}|p{12.5em}|}
	\hline
	\scriptsize{Комбинация} & \scriptsize{с принципом исключений} & \scriptsize{без принципа исключений}  \\ \hline
	\scriptsize{шары различимы}    & $A_n^m=n^{[m]}={\frac{n!}{(n-m)!}}^{\phantom{M}}$ & $\widetilde{A}_n^m=n^m$\phantom{MMMMMMMMM} \\ \hline
	\scriptsize{шары неразличимы}  & $C_n^m=\frac{n!}{m!(n-m)!}$\phantom{MMMM}    & $\widetilde{C}_n^m=C_{n+m-1}^m={\frac{(n+m-1)!}{m!(n-1)!}}^{\phantom{M}}$ \\ \hline
\end{tabular}
\bigskip

\textbf{Число решений} $\left(x_1, \ldots, x_n\right)$ уравнения 
$$x_1+ \ldots + x_n=k$$
в неотрицательных целых $x_i$
%, где $x_i$ есть число появлений $i$-го элемента в данном сочетании. Это число
равно числу $\widetilde{C}_n^k$ сочетаний с повторениями из $n$ элементов по $k$.
\bigskip

\textbf{Задача о беспорядках.}
Требуется найти число перестановок $(p_1, p_2, \ldots, p_n)$ множества $\{1, 2, \ldots , n\}$ таких что $p_i \neq i$ для всех $i$. Такие перестановки называются \defin{беспорядками}.

\begin{theorem}[о числе беспорядков]
	Число беспорядков на множестве из $n$ элементов равно
	$n!\left(1-\frac{1}{1!}+\frac{1}{2!}-\frac{1}{3!}+ ... +(-1)^n\frac{1}{n!}\right).$
\end{theorem}
\textbf{Доказательство} следует из формулы включений-исключений. $\Box$

